<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panoramica AI - Consultant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'pano-lime': '#DCEE6A',
                        'pano-grey': '#9CA3AF',
                        'pano-dark': '#0A0A0A',
                        'pano-border': '#333333',
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.5s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #050505; color: white; font-family: sans-serif; }
        
        /* Nascondi scrollbar ma permetti scroll */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Effetto cursore che lampeggia */
        .typing-cursor::after { content: '|'; animation: blink 1s step-start infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* Stile Input */
        .chat-input:focus { outline: none; box-shadow: 0 0 0 2px #DCEE6A; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <header class="flex-none p-4 border-b border-pano-border bg-black/50 backdrop-blur-md z-10 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded bg-pano-lime/10 flex items-center justify-center border border-pano-lime/30">
                <div class="w-3 h-3 bg-pano-lime rotate-45 shadow-[0_0_10px_#DCEE6A]"></div>
            </div>
            <span class="font-bold tracking-wide">Panoramica <span class="text-pano-lime">AI</span></span>
        </div>
        <a href="index.html" class="text-sm text-pano-grey hover:text-white transition">Exit Chat âœ•</a>
    </header>

    <main id="chat-container" class="flex-grow overflow-y-auto p-4 md:p-8 space-y-6 no-scrollbar relative">
        <div class="absolute inset-0 pointer-events-none flex items-center justify-center opacity-5">
             <div class="w-64 h-64 border border-white rotate-45"></div>
        </div>
    </main>

    <footer class="flex-none p-4 md:p-6 bg-[#050505] border-t border-pano-border">
        <div class="max-w-3xl mx-auto relative">
            <form id="chat-form" class="flex gap-4">
                <input type="text" id="user-input" 
                    class="w-full bg-[#111] border border-pano-border rounded-xl px-4 py-4 text-white placeholder-gray-500 focus:border-pano-lime transition outline-none shadow-lg"
                    placeholder="Type your answer here..." autocomplete="off">
                
                <button type="submit" class="bg-pano-lime text-black p-4 rounded-xl hover:bg-white transition hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                    </svg>
                </button>
            </form>
            <div class="text-center mt-2">
                <p class="text-[10px] text-pano-grey uppercase tracking-widest">Powered by RevOps Logic</p>
            </div>
        </div>
    </footer>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const chatForm = document.getElementById('chat-form');
        const userInput = document.getElementById('user-input');
        
        // DATI UTENTE RACCOLTI
        let userData = {
            name: '',
            company: '',
            painPoint: ''
        };

        // STATO DELLA CONVERSAZIONE
        let step = 0;

        // FUNZIONE: Aggiunge messaggio BOT
        function addBotMessage(text, isHTML = false) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'flex gap-4 max-w-3xl mx-auto animate-fade-in-up';
            
            // Icona Bot
            msgDiv.innerHTML = `
                <div class="w-8 h-8 flex-shrink-0 rounded bg-pano-lime flex items-center justify-center mt-1">
                    <div class="w-2 h-2 bg-black rotate-45"></div>
                </div>
                <div class="bg-[#1a1a1a] text-gray-200 p-4 rounded-2xl rounded-tl-none border border-pano-border/50 shadow-md leading-relaxed text-sm md:text-base">
                    ${isHTML ? text : `<p>${text}</p>`}
                </div>
            `;
            chatContainer.appendChild(msgDiv);
            scrollToBottom();
        }

        // FUNZIONE: Aggiunge messaggio UTENTE
        function addUserMessage(text) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'flex gap-4 max-w-3xl mx-auto justify-end animate-fade-in-up';
            
            msgDiv.innerHTML = `
                <div class="bg-pano-lime/10 text-pano-lime border border-pano-lime/20 p-4 rounded-2xl rounded-tr-none shadow-[0_0_15px_rgba(220,238,106,0.1)] text-sm md:text-base">
                    <p>${text}</p>
                </div>
            `;
            chatContainer.appendChild(msgDiv);
            scrollToBottom();
        }

        // FUNZIONE: Indicatore "Sta scrivendo..."
        function showTypingIndicator() {
            const id = 'typing-' + Date.now();
            const msgDiv = document.createElement('div');
            msgDiv.id = id;
            msgDiv.className = 'flex gap-4 max-w-3xl mx-auto animate-fade-in-up';
            msgDiv.innerHTML = `
                <div class="w-8 h-8 flex-shrink-0 rounded bg-pano-lime/50 flex items-center justify-center mt-1">
                    <div class="w-2 h-2 bg-black rotate-45 animate-spin"></div>
                </div>
                <div class="bg-[#1a1a1a] p-4 rounded-2xl rounded-tl-none border border-pano-border/50 flex gap-2 items-center h-[54px]">
                    <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce"></div>
                    <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                </div>
            `;
            chatContainer.appendChild(msgDiv);
            scrollToBottom();
            return id;
        }

        function removeTypingIndicator(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // SIMULATORE AI
        async function botReply(text, delay = 1000, isHTML = false) {
            const typingId = showTypingIndicator();
            userInput.disabled = true; // Blocca input mentre bot scrive
            
            await new Promise(r => setTimeout(r, delay));
            
            removeTypingIndicator(typingId);
            addBotMessage(text, isHTML);
            userInput.disabled = false;
            userInput.focus();
        }

        // FLUSSO DELLA CHAT
        async function handleFlow(input) {
            input = input.trim();
            if (!input && step !== 4) return; // Impedisce messaggi vuoti tranne alla fine

            // STEP 0: Richiesta Nome
            if (step === 0) {
                userData.name = input;
                addUserMessage(input);
                step++;
                await botReply(`Nice to meet you, ${userData.name}. <br><br>To give you the best advice, what company are you representing today?`);
            } 
            // STEP 1: Richiesta Azienda
            else if (step === 1) {
                userData.company = input;
                addUserMessage(input);
                step++;
                await botReply(`Got it. We've helped many companies scale their revenue operations.<br><br>In one sentence, <strong>what is the biggest friction point</strong> preventing ${userData.company} from growing right now? (e.g., messy data, misaligned teams, manual tasks)`);
            }
            // STEP 2: Pain Points (La parte "Vendita")
            else if (step === 2) {
                userData.painPoint = input;
                addUserMessage(input);
                step++;
                
                // Risposta "Intelligente" generica
                await botReply(`I see. "${userData.painPoint}" is a very common scalability killer.`);
                await botReply(`At Panoramica, we don't just patch these issues. We build a <strong>Revenue Engine</strong> that eliminates manual work and aligns your data perfectly.<br><br>Based on what you told me, you need an architectural fix, not just a band-aid.`);
                
                // Bottone finale
                setTimeout(() => {
                    addBotMessage(`
                        <p class="mb-4 text-white">I've prepared a preliminary audit slot for you tailored to discuss "${userData.painPoint}".</p>
                        <a href="https://meetings-eu1.hubspot.com/panoramica-solutions" target="_blank" 
                           class="block w-full text-center bg-pano-lime text-black font-bold py-4 rounded hover:bg-white hover:scale-105 transition shadow-[0_0_20px_rgba(220,238,106,0.4)]">
                           Book Priority Strategy Call
                        </a>
                        <p class="mt-4 text-xs text-pano-grey text-center">Clicking opens our calendar in a new tab.</p>
                    `, true);
                    
                    // Nascondi input bar alla fine
                    document.querySelector('footer').style.display = 'none';
                }, 1500);
            }
        }

        // INIZIO: Messaggio di benvenuto
        window.onload = async () => {
            await new Promise(r => setTimeout(r, 500));
            addBotMessage("Hello. I am the Panoramica Revenue Architect AI.");
            await botReply("I'm here to analyze if your infrastructure is ready for scale.<br>First, may I know your name?");
        };

        // GESTIONE INVIO MESSAGGI
        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const text = userInput.value;
            if (text) {
                userInput.value = '';
                handleFlow(text);
            }
        });

    </script>
</body>
</html>
